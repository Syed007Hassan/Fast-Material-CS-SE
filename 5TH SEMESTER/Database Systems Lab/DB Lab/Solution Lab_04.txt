--LAB#04 SOLUTION
--1
SELECT ENAME ,JOB, DNAME SAL,GRADE FROM EMP NATURAL JOIN DEPT ,SALGRADE WHERE SAL BETWEEN LOSAL AND HISAL ORDER BY DEPTNO ASC;
--2
SELECT DNAME FROM DEPT NATURAL JOIN  EMP GROUP BY DNAME HAVING COUNT(EMPNO)>2;
--3
SELECT ENAME FROM EMP WHERE SAL IN(SELECT MIN(SAL) FROM EMP GROUP BY(DEPTNO));
--4
SELECT DNAME,DEPTNO FROM DEPT WHERE DEPTNO NOT IN (SELECT DEPTNO FROM EMP);
--5
SELECT ENAME,SAL,DNAME FROM EMP LEFT OUTER JOIN DEPT ON (EMP.DEPTNO=DEPT.DEPTNO);
--6
SELECT ENAME,SAL,DNAME FROM EMP NATURAL JOIN DEPT,SALGRADE WHERE SAL NOT BETWEEN LOSAL AND HISAL AND GRADE=4;
--7
SELECT ENAME,JOB,(SAL*12) AS ANNUAL_SALARY,DEPTNO,DNAME,GRADE FROM EMP NATURAL JOIN DEPT,SALGRADE WHERE SAL BETWEEN LOSAL AND HISAL AND (((SAL*12)>=60000)AND(JOB!='ANALYST'));
--8
SELECT WORKER.ENAME ||' IS '||' SENIOR THAN HIS OWN MANAGER  '||MANAGER.ENAME AS REPORT FROM EMP WORKER,EMP MANAGER WHERE WORKER.MGR=MANAGER.EMPNO AND (TO_CHAR(SYSDATE,'YYYY')-TO_CHAR(WORKER.HIREDATE,'YYYY')) > (TO_CHAR(SYSDATE,'YYYY')-TO_CHAR(MANAGER.HIREDATE,'YYYY'));
--9
SELECT ENAME,SAL,DNAME FROM EMP NATURAL JOIN DEPT,SALGRADE WHERE SAL BETWEEN LOSAL AND HISAL AND GRADE=2;
--10
SELECT ENAME ,JOB, DEPTNO,DNAME, SAL,GRADE FROM EMP NATURAL JOIN DEPT ,SALGRADE WHERE SAL BETWEEN LOSAL AND HISAL ORDER BY DEPTNO ASC,DNAME ASC;
--11
SELECT WORKER.ENAME AS WORKER, MANAGER.ENAME AS MANAGER FROM EMP WORKER, EMP MANAGER WHERE WORKER.MGR = MANAGER.EMPNO AND WORKER.DEPTNO=MANAGER.DEPTNO;
--12
SELECT * FROM EMP WHERE DEPTNO=10 AND SAL >=ALL(SELECT SAL FROM EMP WHERE DEPTNO=30);
--13
SELECT * FROM EMP WHERE DEPTNO!=30 AND SAL >ALL(SELECT SAL FROM EMP WHERE DEPTNO=30);
--14
SELECT * FROM DEPT where DEPTNO NOT IN (SELECT DEPTNO FROM EMP);
--15
SELECT ENAME,DEPTNO,SAL FROM EMP WHERE (DEPTNO,SAL) IN (SELECT DEPTNO,SAL FROM EMP WHERE COMM IS NOT NULL);
--16
SELECT DNAME,TO_CHAR(SUM(SAL+NVL(COMM,0)),'$999999999') AS TOTAL_PAYROLL FROM DEPT NATURAL JOIN  EMP GROUP BY DNAME HAVING SUM(SAL+NVL(COMM,0))>5000 AND DNAME != 'SALES' ORDER BY SUM(SAL+NVL(COMM,0)) DESC;
--17
SELECT WORKER.ENAME AS WORKER, MANAGER.ENAME AS MANAGER FROM EMP WORKER LEFT OUTER JOIN EMP MANAGER ON  WORKER.MGR = MANAGER.EMPNO;
--18
SELECT DISTINCT(JOB),LOC FROM EMP NATURAL JOIN DEPT WHERE DEPTNO =30;
--19
SELECT WORKER.ENAME AS EMPLOYEE, WORKER.EMPNO AS EMP#,MANAGER.ENAME AS MANAGER,WORKER.MGR AS MANAGER# FROM EMP WORKER,EMP MANAGER WHERE WORKER.MGR=MANAGER.EMPNO;
--20
SELECT ENAME FROM EMP WHERE SAL = (SELECT MAX(SAL) FROM EMP WHERE SAL<(SELECT MAX(SAL)FROM EMP));

--For nth highest sal
SELECT ENAME,SAL FROM EMP E1 WHERE n=(SELECT COUNT(DISTINCT E2.SAL) FROM EMP E2 WHERE E2.SAL>=E1.SAL);


